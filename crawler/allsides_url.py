import pandas as pd
from newspaper import Article 
from newspaper import Config
import tqdm

########################################  allsides-small title, text extraction  #########################################

path = '/home/yyko/workspace/political_pre/github/khan/data/kcd_allsides.csv'
dest = '/home/yyko/workspace/political_pre/github/khan/data'

url_df = pd.read_csv(path, encoding='utf-8')
url_df = url_df[['url']]
print(url_df.head())

# user_agent = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'
# config = Config()
# config.browser_user_agent = user_agent

title_list = []
text_list = []
forbidden_idx = []

for index, row in url_df.iterrows():
    try:
        # print(row.url)
        url = row.url
        a = Article(url, language='en')
        a.download()
        a.parse()
        title_list.append(a.title)
        text_list.append(a.text)
    except:
        print("===============ignored the exception===============")
        forbidden_idx.append(index)
        pass

title_df = pd.DataFrame({'title' : title_list})
text_df = pd.DataFrame({'text' : text_list})
forbidden_df = pd.DataFrame({'forbidden_idx' : forbidden_idx})

print(len(title_df))
print(title_df.head())
print(len(text_df))
print(text_df.head())

print(len(forbidden_df))

title_df.to_csv(dest + "/kcd_allsides_title.csv", index=False, encoding='utf-8-sig')
text_df.to_csv(dest + "/kcd_allsides_text.csv", index=False, encoding='utf-8-sig')
forbidden_df.to_csv(dest + "/kcd_allsides_forbidden.csv", index=False, encoding='utf-8-sig')


#############################################  forbidden title extraction  #############################################

path = '/home/yyko/workspace/political_pre/github/khan/data/kcd_allsides.csv'
dest = '/home/yyko/workspace/political_pre/github/khan/data'

title_forbid_df = pd.read_csv(path, encoding='utf-8')
title_forbid_df = title_forbid_df[['title']]
print(title_forbid_df.head())
print(len(title_forbid_df))

forbid_idx = [24,33,84,87,108,109,127,135,155,166,205,217,252,258,279,298,317,322,328,333,335,370,372,447,462,505,507,539,559,585,589,591,598,606,661,663,715,723,751,759,766,778,792,824,828,846,856,862,954,964,984,1002,1055,1209,1298,1299,1317,1336,1338,1347,1359,1401,1404,1432,1434,1469,1473,1530,1545,1572,1665,1716,1776,1785,1850,1868,1902,1923,1947,1952,1956,2018,2022,2044,2046,2075,2077,2096,2157,2179,2214,2224,2229,2234,2239,2279,2287,2293,2294,2296,2303,2308,2325,2337,2351,2353,2357,2376,2389,2391,2399,2406,2413,2427,2430,2438,2455,2461,2480,2483,2495,2526,2534,2540,2561,2614,2622,2638,2666,2696,2697,2700,2702,2709,2722,2736,2744,2747,2749,2778,2788,2800,2806,2813,2825,2834,2844,2848,2852,2855,2860,2863,2867,2868,2869,2871,2876,2877,2881,2886,2888,2890,2892,2896,2905,2909,2914,2929,2931,2935,2943,2946,2947,2951,2953,2956,2957,2958,2959,2963,2972,2974,2987,2989,2995,2998,3014,3020,3022,3027,3034,3045,3058,3060,3061,3065,3069,3073,3075,3080,3082,3085,3088,3096,3107,3114,3116,3118,3122,3124,3126,3132,3136,3138,3143,3148,3153,3163,3166,3172,3175,3176,3177,3181,3185,3188,3190,3196,3203,3205,3220,3224,3226,3231,3236,3238,3241,3245,3246,3256,3259,3262,3275,3284,3285,3289,3292,3299,3300,3305,3306,3311,3316,3317,3319,3325,3327,3335,3336,3339,3344,3351,3353,3354,3357,3360,3361,3363,3372,3376,3377,3387,3392,3396,3398,3400,3402,3405,3410,3411,3413,3414,3421,3432,3436,3438,3440,3445,3447,3450,3455,3466,3473,3474,3479,3485,3490,3497,3502,3504,3512,3514,3520,3528,3534,3537,3539,3562,3563,3566,3567,3570,3574,3578,3581,3584,3586,3596,3597,3602,3609,3617,3619,3621,3622,3625,3631,3644,3645,3646,3648,3649,3652,3658,3660,3661,3667,3671,3676,3682,3683,3684,3686,3693,3695,3696,3697,3700,3704,3705,3706,3710,3715,3717,3720,3721,3725,3727,3731,3732,3735,3738,3739,3742,3751,3755,3758,3763,3765,3770,3774,3778,3782,3783,3784,3788,3789,3794,3795,3799,3813,3818,3830,3831,3840,3851,3856,3882,3897,3903,3910,3911,3923,3936,3938,3939,3945,3948,3987,3993,3998,4031,4034,4049,4061,4071,4087,4094,4108,4113,4119,4125,4134,4142,4143,4182,4215,4224,4229,4242,4251,4254,4257,4267,4281,4286,4294,4296,4298,4299,4313,4314,4328,4329,4338,4340,4352,4358,4372,4381,4385,4388,4390,4394,4411,4421,4423,4443,4473,4481,4511,4539,4544,4557,4574,4580,4582,4610,4663,4685,4688,4692,4698,4710,4738,4751,4777,4822,4858,4862,4865,4871,4891,4915,4925,4928,4944,4979,4985,4988,4991,4992,4994,5003,5007,5031,5032,5046,5048,5063,5072,5073,5078,5083,5119,5122,5123,5126,5132,5135,5151,5159,5167,5173,5198,5205,5208,5216,5221,5228,5234,5240,5246,5262,5266,5271,5272,5274,5279,5281,5283,5298,5302,5345,5375,5381,5389,5399,5417,5423,5424,5427,5477,5482,5526,5535,5540,5544,5612,5613,5630,5635,5780,5811,5828,5845,5882,5895,5938,5943,5952,5958,5964,5967,5979,5988,5997,6093,6095,6100,6107,6110,6113,6125,6128,6130,6138,6162,6180,6184,6187,6202,6218,6230,6233,6235,6238,6240,6274,6285,6331,6368,6376,6380,6384,6386,6398,6401,6403,6416,6442,6451,6462,6469,6486,6487,6502,6507,6510,6529,6631,6634,6654,6656,6665,6673,6683,6688,6690,6698,6715,6721,6729,6738,6746,6747,6753,6760,6764,6784,6800,6803,6837,6903,6962,6992,6997,7015,7022,7056,7075,7088,7112,7127,7133,7138,7140,7142,7149,7179,7225,7228,7242,7257,7285,7315,7324,7333,7350,7357,7359,7366,7382,7388,7394,7407,7408,7426,7432,7443,7465,7466,7476,7480,7494,7499,7521,7544,7555,7565,7567,7572,7592,7601,7621,7662,7665,7669,7683,7736,7743,7757,7766,7773,7775,7780,7795,7825,7830,7845,7853,7858,7878,7880,7882,7884,7906,7925,7930,7937,7942,7945,7947,7964,7968,7994,7996,7998,8024,8027,8032,8073,8079,8115,8126,8136,8138,8140,8152,8159,8160,8161,8168,8170,8204,8209,8217,8241,8263,8265,8269,8289,8304,8308,8313,8317,8321,8328,8334,8335,8342,8343,8363,8366,8367,8388,8389,8398,8412,8415,8428,8446,8452,8454,8459,8477,8488,8499,8503,8524,8528,8537,8548,8558,8576,8590,8601,8613,8616,8645,8663,8667,8678,8688,8719,8724,8762,8776,8778,8779,8791,8793,8813,8837,8845,8846,8862,8870,8874,8899,8938,8953,8957,8978,9005,9018,9019,9025,9049,9062,9065,9078,9089,9098,9114,9123,9129,9135,9148,9175,9223,9230,9272,9314,9330,9337,9350,9353,9356,9363,9377,9413,9430,9453,9458,9475,9495,9504,9508,9537,9557,9580,9596,9606,9616,9626,9684,9704,9746,9748,9789,9818,9886,9889,9907,9938,9942,9967,9988,10023,10040,10059,10106,10137,10139,10172,10199,10274,10286,10324,10344,10398,10411,10449,10461,10495,10557,10565,10593,10598,10603,10625,10682,10684,10760,10790,10818,10876,10879,10904,10928,10929,10940,10942,10991,11022,11063,11082,11087,11098,11115,11132,11157,11167,11192,11214,11226,11283,11293,11313,11355,11359,11380,11381,11398,11402,11412,11470,11478,11499,11505,11535,11540,11562,11568,11587,11601,11618,11789,11792,11797,11813,11829,11953,11964,12048,12191,12288,12323,12383,12410,12441,12466,12555,12567,12572,12636,12662,12849,12929,12950,13103,13192,13206,13210,13216,13217,13219,13220,13233,13237,13238,13239,13242,13251,13266,13272,13275,13278,13281,13287,13302,13304,13321,13341,13342,13345,13348,13349,13353,13356,13361,13363,13365,13367,13382,13384,13385,13396,13403,13412,13420,13437,13441,13444,13448,13458,13459,13474,13475,13491,13499,13500,13501,13505,13509,13512,13515,13519,13526,13527,13530,13532,13534,13535,13543,13546,13549,13565,13581,13600,13606,13607,13612,13616,13619,13626,13636,13647,13650,13660,13664,13665,13668,13670,13686,13687,13690,13693,13694,13698,13704,13708,13716,13717,13720,13722,13724,13728,13729,13732,13750,13753,13760,13783,13784,13792,13816,13828,13830,13845,13847,13851,13859,13865,13867,13868,13883,13898,13899,13901,13912,13923,13925,13933,13934,13939,13940,13947,13964,13969,13976,13981,13983,14000,14005,14007,14017,14020,14022,14023,14028,14032,14040,14042,14050,14057,14066,14077,14079,14090,14093,14096,14105,14119,14129,14132,14138,14145,14149,14158,14164,14166,14167,14176,14178,14179,14180,14181,14182,14185,14189,14190,14193,14201,14205,14215,14226,14228,14232,14233,14243,14252,14255,14262,14266,14269,14273,14287,14293,14296,14297,14300,14304,14307,14310,14320,14323,14332,14343,14344,14360,14372,14390,14391,14394,14407,14425,14426,14428,14436,14437,14439,14448,14471,14477,14480,14487,14491,14498,14499,14524,14545,14555,14556,14561,14579,14600,14603,14610,14611,14618,14623,14630,14632,14636,14646,14648,14653,14654,14660,14675,14680,14698,14701,14708,14710,14714,14723,14736,14737,14740,14748,14750,14755,14767,14782,14784,14799,14802,14803,14808,14827,14831,14856,14861,14891,14898,14930,14935,14953,14954,14955,14960,14967,14977,14979,14984,14997,15019,15023,15028,15030,15035,15037,15047,15049,15067,15070,15073,15074,15080,15092,15097,15111,15114,15115,15123,15125,15132,15134,15141,15155,15173,15174,15185,15187,15199,15202,15206,15207,15212,15216,15225,15234,15246,15250,15255,15257,15262,15267,15273,15274,15277,15278,15292,15296,15303,15304,15306,15308,15322,15323,15331,15338,15353,15364,15366,15373,15384,15393,15394,15401,15406,15410,15418,15424,15428,15429,15435,15442,15453,15454,15456,15467,15473,15477,15483,15492,15525,15535,15538,15552,15554,15555,15563,15568,15571,15573,15579,15580,15587,15588,15592,15602,15604,15620,15625,15639,15645,15649,15651,15652,15678,15679,15687,15693,15699,15705,15709,15713,15719,15726,15728,15730,15753,15769,15776,15779,15799,15802,15813,15828,15840,15844,15862,15874,15879,15882,15909,15911,15912,15913,15924,15930,15931,15933,15940,15944,15945,15949,15950,15952,15967,15972,15974,15983,15984,15995,16002,16007,16011,16014,16015,16018,16027,16033,16035,16042,16043,16046,16052,16062,16065,16066,16068,16085,16088,16090,16124,16125,16132,16135,16136,16159,16172,16183,16184,16196,16202,16213,16214,16220,16226,16231,16239,16240,16244,16249,16252,16254,16256,16257,16258,16260,16280,16284,16299,16300,16311,16323,16324,16332,16343,16367,16382,16393,16404,16406,16411,16424,16441,16442,16446,16454,16466,16467,16468,16477,16494,16500,16513,16517,16522,16528,16531,16544,16551,16556,16570,16575,16579,16584,16610,16628,16637,16642,16650,16655,16663,16684,16693,16699,16714,16725,16734,16735,16738,16742,16745,16756,16758,16769,16775,16793,16800,16817,16819,16821,16837,16838,16843,16847,16850,16856,16866,16875,16895,16904,16907,16912,16915,16938,16946,16949,16950,16951,16953,16954,16964,16966,16987,16997,17010,17012,17021,17035,17040,17052,17056,17068,17073,17086,17095,17101,17107,17112,17115,17139,17140,17142,17145,17153,17155,17161,17162,17169,17184,17185,17186,17191,17193,17194,17211,17216,17222,17230,17243,17244,17253,17284,17299,17325,17332,17336,17361,17373,17387,17389,17391,17400,17406,17412,17415,17424,17428,17432,17447,17464,17466,17469,17478,17482,17484,17493,17496,17502,17510,17514,17530,17536,17548,17553,17570,17572,17575,17579,17596,17618,17642,17648,17661,17664,17668,17676,17683,17684,17697,17740,17742,17752,17765,17771,17772,17783,17789,17790,17797,17801,17803,17807,17808,17811,17813,17838,17842,17847,17853,17865,17868,17880,17933,18014]
idx = 0
title_list = []
# print(forbid_idx[0])

for index, row in title_forbid_df.iterrows():
    if index == forbid_idx[idx]:
        idx += 1
        title_list.append(row.title)
        if idx == 1613:
            break

title_df = pd.DataFrame({'forbidden_title' : title_list})
print(len(title_df))

title_df.to_csv(dest + "/kcd_allsides_forbidden_title_extraction.csv", index=False, encoding='utf-8-sig')


#############################################  title, text, label concatenation  #############################################

path_title = '/home/yyko/workspace/political_pre/github/khan/data/kcd_allsides_title.csv'
path_text = '/home/yyko/workspace/political_pre/github/khan/data/kcd_allsides_text.csv'
path_label = '/home/yyko/workspace/political_pre/github/khan/data/kcd_allsides.csv'

dest = '/home/yyko/workspace/political_pre/github/khan/data'

title_df = pd.read_csv(path_title, encoding='utf-8')
text_df = pd.read_csv(path_text, encoding='utf-8')
label_df = pd.read_csv(path_label, encoding='utf-8')

title_df = title_df[['title']]
text_df = text_df[['text']]
label_df = label_df[['title', 'label']]

a = 0
for index, row in text_df.iterrows():
    # print(len(str(text_df['text'][index])))
    
    if len(str(text_df['text'][index])) > 30000:
        a += 1
        s = str(text_df['text'][index])
        text_df['text'][index] = s[0:30000]

print(a)

print(len(title_df))
print(title_df.head())
print(len(text_df))
print(text_df.head())
print(len(label_df))
print(label_df.head())

title_text_df = pd.concat([title_df, text_df], axis = 1)
print(len(title_text_df))
print(title_text_df.head())

forbid_idx = [24,33,84,87,108,109,127,135,155,166,205,217,252,258,279,298,317,322,328,333,
              335,370,372,447,462,505,507,539,559,585,589,591,598,606,661,663,715,723,751,
              759,766,778,792,824,828,846,856,862,954,964,984,1002,1055,1209,1298,1299,1317,
              1336,1338,1347,1359,1401,1404,1432,1434,1469,1473,1530,1545,1572,1665,1716,1776,
              1785,1850,1868,1902,1923,1947,1952,1956,2018,2022,2044,2046,2075,2077,2096,2157,
              2179,2214,2224,2229,2234,2239,2279,2287,2293,2294,2296,2303,2308,2325,2337,2351,
              2353,2357,2376,2389,2391,2399,2406,2413,2427,2430,2438,2455,2461,2480,2483,2495,
              2526,2534,2540,2561,2614,2622,2638,2666,2696,2697,2700,2702,2709,2722,2736,2744,
              2747,2749,2778,2788,2800,2806,2813,2825,2834,2844,2848,2852,2855,2860,2863,2867,
              2868,2869,2871,2876,2877,2881,2886,2888,2890,2892,2896,2905,2909,2914,2929,2931,
              2935,2943,2946,2947,2951,2953,2956,2957,2958,2959,2963,2972,2974,2987,2989,2995,
              2998,3014,3020,3022,3027,3034,3045,3058,3060,3061,3065,3069,3073,3075,3080,3082,
              3085,3088,3096,3107,3114,3116,3118,3122,3124,3126,3132,3136,3138,3143,3148,3153,
              3163,3166,3172,3175,3176,3177,3181,3185,3188,3190,3196,3203,3205,3220,3224,3226,
              3231,3236,3238,3241,3245,3246,3256,3259,3262,3275,3284,3285,3289,3292,3299,3300,
              3305,3306,3311,3316,3317,3319,3325,3327,3335,3336,3339,3344,3351,3353,3354,3357,
              3360,3361,3363,3372,3376,3377,3387,3392,3396,3398,3400,3402,3405,3410,3411,3413,
              3414,3421,3432,3436,3438,3440,3445,3447,3450,3455,3466,3473,3474,3479,3485,3490,
              3497,3502,3504,3512,3514,3520,3528,3534,3537,3539,3562,3563,3566,3567,3570,3574,
              3578,3581,3584,3586,3596,3597,3602,3609,3617,3619,3621,3622,3625,3631,3644,3645,
              3646,3648,3649,3652,3658,3660,3661,3667,3671,3676,3682,3683,3684,3686,3693,3695,
              3696,3697,3700,3704,3705,3706,3710,3715,3717,3720,3721,3725,3727,3731,3732,3735,
              3738,3739,3742,3751,3755,3758,3763,3765,3770,3774,3778,3782,3783,3784,3788,3789,
              3794,3795,3799,3813,3818,3830,3831,3840,3851,3856,3882,3897,3903,3910,3911,3923,
              3936,3938,3939,3945,3948,3987,3993,3998,4031,4034,4049,4061,4071,4087,4094,4108,
              4113,4119,4125,4134,4142,4143,4182,4215,4224,4229,4242,4251,4254,4257,4267,4281,
              4286,4294,4296,4298,4299,4313,4314,4328,4329,4338,4340,4352,4358,4372,4381,4385,
              4388,4390,4394,4411,4421,4423,4443,4473,4481,4511,4539,4544,4557,4574,4580,4582,
              4610,4663,4685,4688,4692,4698,4710,4738,4751,4777,4822,4858,4862,4865,4871,4891,
              4915,4925,4928,4944,4979,4985,4988,4991,4992,4994,5003,5007,5031,5032,5046,5048,
              5063,5072,5073,5078,5083,5119,5122,5123,5126,5132,5135,5151,5159,5167,5173,5198,
              5205,5208,5216,5221,5228,5234,5240,5246,5262,5266,5271,5272,5274,5279,5281,5283,
              5298,5302,5345,5375,5381,5389,5399,5417,5423,5424,5427,5477,5482,5526,5535,5540,
              5544,5612,5613,5630,5635,5780,5811,5828,5845,5882,5895,5938,5943,5952,5958,5964,
              5967,5979,5988,5997,6093,6095,6100,6107,6110,6113,6125,6128,6130,6138,6162,6180,
              6184,6187,6202,6218,6230,6233,6235,6238,6240,6274,6285,6331,6368,6376,6380,6384,
              6386,6398,6401,6403,6416,6442,6451,6462,6469,6486,6487,6502,6507,6510,6529,6631,
              6634,6654,6656,6665,6673,6683,6688,6690,6698,6715,6721,6729,6738,6746,6747,6753,
              6760,6764,6784,6800,6803,6837,6903,6962,6992,6997,7015,7022,7056,7075,7088,7112,
              7127,7133,7138,7140,7142,7149,7179,7225,7228,7242,7257,7285,7315,7324,7333,7350,
              7357,7359,7366,7382,7388,7394,7407,7408,7426,7432,7443,7465,7466,7476,7480,7494,
              7499,7521,7544,7555,7565,7567,7572,7592,7601,7621,7662,7665,7669,7683,7736,7743,
              7757,7766,7773,7775,7780,7795,7825,7830,7845,7853,7858,7878,7880,7882,7884,7906,
              7925,7930,7937,7942,7945,7947,7964,7968,7994,7996,7998,8024,8027,8032,8073,8079,
              8115,8126,8136,8138,8140,8152,8159,8160,8161,8168,8170,8204,8209,8217,8241,8263,
              8265,8269,8289,8304,8308,8313,8317,8321,8328,8334,8335,8342,8343,8363,8366,8367,
              8388,8389,8398,8412,8415,8428,8446,8452,8454,8459,8477,8488,8499,8503,8524,8528,
              8537,8548,8558,8576,8590,8601,8613,8616,8645,8663,8667,8678,8688,8719,8724,8762,
              8776,8778,8779,8791,8793,8813,8837,8845,8846,8862,8870,8874,8899,8938,8953,8957,
              8978,9005,9018,9019,9025,9049,9062,9065,9078,9089,9098,9114,9123,9129,9135,9148,
              9175,9223,9230,9272,9314,9330,9337,9350,9353,9356,9363,9377,9413,9430,9453,9458,
              9475,9495,9504,9508,9537,9557,9580,9596,9606,9616,9626,9684,9704,9746,9748,9789,
              9818,9886,9889,9907,9938,9942,9967,9988,10023,10040,10059,10106,10137,10139,10172,
              10199,10274,10286,10324,10344,10398,10411,10449,10461,10495,10557,10565,10593,10598,
              10603,10625,10682,10684,10760,10790,10818,10876,10879,10904,10928,10929,10940,10942,
              10991,11022,11063,11082,11087,11098,11115,11132,11157,11167,11192,11214,11226,11283,
              11293,11313,11355,11359,11380,11381,11398,11402,11412,11470,11478,11499,11505,11535,
              11540,11562,11568,11587,11601,11618,11789,11792,11797,11813,11829,11953,11964,12048,
              12191,12288,12323,12383,12410,12441,12466,12555,12567,12572,12636,12662,12849,12929,
              12950,13103,13192,13206,13210,13216,13217,13219,13220,13233,13237,13238,13239,13242,
              13251,13266,13272,13275,13278,13281,13287,13302,13304,13321,13341,13342,13345,13348,
              13349,13353,13356,13361,13363,13365,13367,13382,13384,13385,13396,13403,13412,13420,
              13437,13441,13444,13448,13458,13459,13474,13475,13491,13499,13500,13501,13505,13509,
              13512,13515,13519,13526,13527,13530,13532,13534,13535,13543,13546,13549,13565,13581,
              13600,13606,13607,13612,13616,13619,13626,13636,13647,13650,13660,13664,13665,13668,
              13670,13686,13687,13690,13693,13694,13698,13704,13708,13716,13717,13720,13722,13724,
              13728,13729,13732,13750,13753,13760,13783,13784,13792,13816,13828,13830,13845,13847,
              13851,13859,13865,13867,13868,13883,13898,13899,13901,13912,13923,13925,13933,13934,
              13939,13940,13947,13964,13969,13976,13981,13983,14000,14005,14007,14017,14020,14022,
              14023,14028,14032,14040,14042,14050,14057,14066,14077,14079,14090,14093,14096,14105,
              14119,14129,14132,14138,14145,14149,14158,14164,14166,14167,14176,14178,14179,14180,
              14181,14182,14185,14189,14190,14193,14201,14205,14215,14226,14228,14232,14233,14243,
              14252,14255,14262,14266,14269,14273,14287,14293,14296,14297,14300,14304,14307,14310,
              14320,14323,14332,14343,14344,14360,14372,14390,14391,14394,14407,14425,14426,14428,
              14436,14437,14439,14448,14471,14477,14480,14487,14491,14498,14499,14524,14545,14555,
              14556,14561,14579,14600,14603,14610,14611,14618,14623,14630,14632,14636,14646,14648,
              14653,14654,14660,14675,14680,14698,14701,14708,14710,14714,14723,14736,14737,14740,
              14748,14750,14755,14767,14782,14784,14799,14802,14803,14808,14827,14831,14856,14861,
              14891,14898,14930,14935,14953,14954,14955,14960,14967,14977,14979,14984,14997,15019,
              15023,15028,15030,15035,15037,15047,15049,15067,15070,15073,15074,15080,15092,15097,
              15111,15114,15115,15123,15125,15132,15134,15141,15155,15173,15174,15185,15187,15199,
              15202,15206,15207,15212,15216,15225,15234,15246,15250,15255,15257,15262,15267,15273,
              15274,15277,15278,15292,15296,15303,15304,15306,15308,15322,15323,15331,15338,15353,
              15364,15366,15373,15384,15393,15394,15401,15406,15410,15418,15424,15428,15429,15435,
              15442,15453,15454,15456,15467,15473,15477,15483,15492,15525,15535,15538,15552,15554,
              15555,15563,15568,15571,15573,15579,15580,15587,15588,15592,15602,15604,15620,15625,
              15639,15645,15649,15651,15652,15678,15679,15687,15693,15699,15705,15709,15713,15719,
              15726,15728,15730,15753,15769,15776,15779,15799,15802,15813,15828,15840,15844,15862,
              15874,15879,15882,15909,15911,15912,15913,15924,15930,15931,15933,15940,15944,15945,
              15949,15950,15952,15967,15972,15974,15983,15984,15995,16002,16007,16011,16014,16015,
              16018,16027,16033,16035,16042,16043,16046,16052,16062,16065,16066,16068,16085,16088,
              16090,16124,16125,16132,16135,16136,16159,16172,16183,16184,16196,16202,16213,16214,
              16220,16226,16231,16239,16240,16244,16249,16252,16254,16256,16257,16258,16260,16280,
              16284,16299,16300,16311,16323,16324,16332,16343,16367,16382,16393,16404,16406,16411,
              16424,16441,16442,16446,16454,16466,16467,16468,16477,16494,16500,16513,16517,16522,
              16528,16531,16544,16551,16556,16570,16575,16579,16584,16610,16628,16637,16642,16650,
              16655,16663,16684,16693,16699,16714,16725,16734,16735,16738,16742,16745,16756,16758,
              16769,16775,16793,16800,16817,16819,16821,16837,16838,16843,16847,16850,16856,16866,
              16875,16895,16904,16907,16912,16915,16938,16946,16949,16950,16951,16953,16954,16964,
              16966,16987,16997,17010,17012,17021,17035,17040,17052,17056,17068,17073,17086,17095,
              17101,17107,17112,17115,17139,17140,17142,17145,17153,17155,17161,17162,17169,17184,
              17185,17186,17191,17193,17194,17211,17216,17222,17230,17243,17244,17253,17284,17299,
              17325,17332,17336,17361,17373,17387,17389,17391,17400,17406,17412,17415,17424,17428,
              17432,17447,17464,17466,17469,17478,17482,17484,17493,17496,17502,17510,17514,17530,
              17536,17548,17553,17570,17572,17575,17579,17596,17618,17642,17648,17661,17664,17668,
              17676,17683,17684,17697,17740,17742,17752,17765,17771,17772,17783,17789,17790,17797,
              17801,17803,17807,17808,17811,17813,17838,17842,17847,17853,17865,17868,17880,17933,
              18014]
idx = 0
label_match_list = []
# print(forbid_idx[0])

for index, row in label_df.iterrows(): # 18155번 반복
    if idx == 1613:
        label_match_list.append(row.label)
    else:
        if index != forbid_idx[idx]: # forbid_idx list 크기: 1613
            label_match_list.append(row.label)
        else:
            idx += 1

# label_match_list = []
# for index_t, row_t in title_text_df.iterrows():
#     for index_l, row_l in label_df.iterrows():
#         if row_t.title == row_l.title:
#             label_match_list.append(row_l.label)

label_df = pd.DataFrame({'label' : label_match_list})
print(len(label_df))
print(label_df.head())

title_text_label_df = pd.concat([title_text_df, label_df], axis = 1)
print(len(title_text_label_df))
print(title_text_label_df.head())

title_text_label_df.to_csv(dest + "/kcd_allsides_title_text_label.csv", index=False, encoding='utf-8-sig')
